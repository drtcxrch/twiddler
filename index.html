<!DOCTYPE html>
<html>
  <head>
    <title>Twiddler</title>
    <script src="jquery.js"></script>
    <script src="dataGenerator.js"></script>
    <script src="jquery.timeago.js" type="text/javascript"></script>
    <link  rel="stylesheet" href="stylesheet.css">
  </head>

  <body>
    <div class="container">
      <img class="logo" src="LogoMakr_1kOL8J.png" alt="Twiddler"><br>
      <button class="home">Home</button>
      <div class="username">Enter username: <br><input id="username" type="text" name="username">
        <form id='submit' method='get' action=''>
        </form>
        <button class="submit">Post your Tweed!</button>
        <button id="tweet">Get latest Tweeds!</button>
      </div>

      <div id="username"></div>
      <div class="tweets">
        <section class="main">

        </section>
      </div>
    </div>

    <script>

      $(document).ready(function(){
        var $body = $('.tweets');
        var currentFeedLength = 11;

        //Populate initial feed

        function poplulateFeed() {

          var index = streams.home.length - 1;
          while (index >= 0) {
            var tweet = streams.home[index];
            var $tweet = $('<div class="tweet"></div>');
            var $user = $('<p class="user"></p>');
            $('.home').hide();
           $tweet.appendTo('.main');
            $user.addClass(tweet.user).attr('data-user', tweet.user).html('<b>@' + tweet.user + ': </b>' + tweet.message + '<span> - <em>' + jQuery.timeago(tweet.created_at) + '</em></span>').appendTo($tweet);
            index -= 1;
          }

        }

        poplulateFeed();

        //Click function to get more tweets

        $("#tweet").click(function() {
          generateRandomTweet();
          $('.main').children(".tweet").remove();
          poplulateFeed();

        });

        //Go to user feed

        $('.tweets').on('click', '.user', function (event) {
          event.preventDefault();
          var user = $(this).data('user');
          $('.userpage').remove();
          var $userpage = $('<h1 class=userpage>' + user + '\'s Tweeds</h1>');
          $userpage.prependTo($body);
          $('.newTweets').hide();
          $('#username').hide();
          $('.home').show();
          $('#tweet').hide();
          $('.tweet').not("div:contains('" + user + "')").hide();
          $("div:contains('" + user + "')").show();

        });

        //Go back to main feed

        $('.home').click(function (event) {
          event.preventDefault();
          var user = $(this).data('user');
          $('.userpage').hide();
          $('.newTweets').show();
          $('#tweet').show();
          $('.home').hide();
          $('#username').show();
          $("div:contains('" + user + "')").hide();
          $('.tweet').not("div:contains('" + user + "')").show();

        })

        //Write new tweet

        var $textarea = $("<textarea placeholder='Share your thoughts with the Twiddlerverse!' id='text' name='text' rows='2' style='overflow: hidden; word-wrap: break-word; resize: none; height: auto;'></textarea>");
        $textarea.appendTo('#submit');

        $('.submit').on('click', function () {

          var $tweet = $('<div class=tweet></div>');
          var $user = $('<p class=user></p>');
          var tweet = {};
          tweet.user = $('input#username').val();
          tweet.message = $('textarea').val()
          tweet.created_at = new Date();
          streams.home.push(tweet);

          $('.home').hide();
          $tweet.prependTo('.main');
          $user.addClass(tweet.user).attr('data-user', tweet.user).html('<b>@' + tweet.user + ': </b>' + tweet.message + '<span>  - <em>' + jQuery.timeago(tweet.created_at) + '</em></span>').appendTo($tweet);
          $('textarea').val('').blur();
        });

      });

    </script>
  </body>
</html>
